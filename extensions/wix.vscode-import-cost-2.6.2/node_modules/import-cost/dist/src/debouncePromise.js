'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.DebounceError = undefined;

var _promise = require('babel-runtime/core-js/promise');

var _promise2 = _interopRequireDefault(_promise);

exports.debouncePromise = debouncePromise;

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var promises = {};

var DebounceError = exports.DebounceError = new Error('DebounceError');

function debouncePromise(key, fn) {
  var delay = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 500;

  var promise = new _promise2.default(function (resolve, reject) {
    setTimeout(function () {
      return promises[key] === promise ? new _promise2.default(fn).then(resolve).catch(reject) : reject(DebounceError);
    }, delay);
  });
  return promises[key] = promise;
}